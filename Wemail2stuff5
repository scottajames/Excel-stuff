Sub ExportFilteredSheetsToNewWorkbook()
    ' Declare variables
    Dim originalWorkbook As Workbook
    Dim wsEmployee As Worksheet, wsUnit As Worksheet
    Dim newWorkbook As Workbook
    Dim filterRangeEmployee As Range, filterRangeUnit As Range
    
    ' Set references to the current workbook and worksheets
    Set originalWorkbook = ThisWorkbook
    Set wsEmployee = originalWorkbook.Worksheets("Employee Listing")
    Set wsUnit = originalWorkbook.Worksheets("Unit")
    
    ' Turn off screen updating for better performance
    Application.ScreenUpdating = False
    
    ' Clear any existing filters
    If wsEmployee.AutoFilterMode Then wsEmployee.AutoFilterMode = False
    If wsUnit.AutoFilterMode Then wsUnit.AutoFilterMode = False
    
    ' Create a new workbook for the filtered data
    Set newWorkbook = Workbooks.Add
    
    ' Delete default sheets in the new workbook
    Application.DisplayAlerts = False ' Suppress confirmation prompts
    Do While newWorkbook.Worksheets.Count > 0
        newWorkbook.Worksheets(1).Delete
    Loop
    Application.DisplayAlerts = True
    
    ' 1. Process and export Employee Listing with filter
    Set filterRangeEmployee = wsEmployee.UsedRange
    With filterRangeEmployee
        ' Apply filter to Column H (8th column)
        .AutoFilter Field:=8, Criteria1:="AS - Central South Command Unit"
        
        ' Copy visible (filtered) data to new workbook
        On Error Resume Next ' Skip if no data matches filter
        wsEmployee.Copy Before:=newWorkbook.Sheets(1)
        newWorkbook.Worksheets(1).Name = "Employee Listing"
        On Error GoTo 0
    End With
    
    ' 2. Process and export Unit sheet with filter
    Set filterRangeUnit = wsUnit.UsedRange
    With filterRangeUnit
        ' Apply filter to Column C (3rd column) with wildcard
        .AutoFilter Field:=3, Criteria1:="*BCU AS*"
        
        ' Copy visible (filtered) data to new workbook
        On Error Resume Next ' Skip if no data matches filter
        wsUnit.Copy After:=newWorkbook.Sheets(1)
        newWorkbook.Worksheets(2).Name = "Unit"
        On Error GoTo 0
    End With
    
    ' Clear filters in the original workbook
    If wsEmployee.AutoFilterMode Then wsEmployee.AutoFilterMode = False
    If wsUnit.AutoFilterMode Then wsUnit.AutoFilterMode = False
    
    ' Turn screen updating back on
    Application.ScreenUpdating = True
    
    ' Activate the new workbook and inform user
    newWorkbook.Activate
    MsgBox "Successfully created new workbook with:" & vbCrLf & _
           "- Filtered 'Employee Listing' sheet" & vbCrLf & _
           "- Filtered 'Unit' sheet", vbInformation, "Process Complete"
End Sub
